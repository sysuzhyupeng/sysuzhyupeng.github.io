---
layout: post
title: 大型网站架构
description: 大型网站架构.
category: blog
---

大型网站架构
-
为了解决大型网站面临的高并发访问、海量数据处理、高可靠运行等一系列问题与挑战，大型互联网公司在实践中提出了许多解决方案，以实现网站高性能、高可用、易伸缩、可扩展、安全等各种技术架构目标。这些解决方案又被更多网站重复使用，从而逐渐形成大型网站架构模式。`分层`是企业应用系统中最常见的一种架构模式，将系统在横向维度上切分成几个部分，每个部分负责一部分相对比较单一的职责，然后通过上层对下层的依赖和调用组成一个完整的系统。分层结构在计算机世界中无处不在，网络的 7层通信协议是一种分层结构;计算机硬件、操作系统、应用软件也可以看作是一种分层结构。在大型网站架构中也采用分层结构，将网站软件系统分为`应用层`(负责具体业务和视图展示，如网站首页及搜索输入和结果展示)、`服务层`(为应用层提供服务支持，如用户管理服务，购物车服务等)、`数据层`(提供数据存储访问服务，如数据库、缓存、文件、搜索引擎等)。通过分层，可以更好地将一个庞大的软件系统切分成不同的部分，便于分工合作开发和维护;各层之间具有一定的独立性。

分割
-
如果说分层是将软件在横向方面进行切分，那么分割就是在纵向方面对软件进行切分。大型网站分割的粒度可能会很小。比如在应用层，将不同业务进行分割，例如将购物、论坛、搜索、广告分割成不同的应用，由独立的团队负责，部署在`不同服务器`上;在同一个应用内部，如果规模庞大业务复杂，会继续进行分割，比如购物业务，可以进一步分割成机票酒店业务、3C 业务， 小商品业务等更细小的粒度。

分布式
-
对于大型网站，分层和分割的一个主要目的是为了切分后的模块便于分布式部署，即将不同模块 部署在不同的服务器上，通过远程调用协同工作。分布式意味着可以使用更多的计算机完成同样的功能，计算机越多，CPU、内存、存储资源也就越多，能够处理的并发访问和数据量就越大，进而能够为更多的用户提供服务。但分布式在解决网站高并发问题的同时也带来了其他问题。首先，分布式意味着服务调用必须`通过网络`，这可能会对性能造成比较严重的影响;其次，服务器越多，服务器宕机的概率也就越大。
常用的分布式方案有以下几种：

* 分布式应用和服务:将分层和分割后的应用和服务模块分布式部署，除了可以改善网站性能和并发性、加快开发和发布速度、减少数据库连接资源消耗外;还可以使不同应用复用共同的服务，便于业务功能扩展。
* 分布式静态资源:网站的静态资源如 JS，CSS，Logo 图片等资源独立分布式部署，并采用独立的域名，即人们常说的动静分离。静态资源分布式部署可以减轻应用服务器的负载压力;通过使用独 立域名加快浏览器并发加载的速度;
* 分布式数据和存储:大型网站需要处理以 P 为单位的海量数据，单台计算机无法提供如此大的存储空间，这些数据需要分布式存储。除了对传统的关系数据库进行分布式部署外，为网站应用而生的 各种 NoSQL产品几乎都是分布式的。
* 分布式计算:严格说来，应用、服务、实时数据处理都是计算，网站除了要处理这些在线业务，还有很大一部分用户没有直观感受的后台业务要处理，包括搜索引擎的索引构建、数据仓库的数据分析统计等。这些业务的计算规模非常庞大，目前网站普遍使用 Hadoop及其MapReduce分布式计算框架进行此类批处理计算，其特点是移动计算而不是移动数据，将计算程序分发到数据所在的位置以加速计算和分布式计算。

集群
-
使用分布式虽然已经将分层和分割后的模块独立部署，但是对于用户访问集中的模块(比如网站首页)，还需要将独立部署的服务器集群化，即多台服务器部署相同应用构成一个集群，通过负载均衡设备共同对外提供服务。因为服务器集群有更多服务器提供相同服务，因此可以提供更好的并发特性，当有更多用户访问的时候，只需要向集群中加入新的机器即可。同时因为一个应用由多台服务器提供，当某台服务器发生故障时，负载均衡设备或者系统的失效转移机制会将请求转发到集群中其他服务器上，使服务器故 障不影响用户使用。所以在网站应用中，`即使是访问量很小的分布式应用和服务，也至少要部署两台服务器构成一个小的集群，目的就是提高系统的可用性`。
  
